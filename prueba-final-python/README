[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/fredusho/data-science-portfolio/blob/main/prueba-final-python/prueba-final.ipynb)




# Análisis de Datos con PostgreSQL y Python

## 🧩 Descripción del proyecto
Este proyecto desarrolla un **análisis integral de datos utilizando Python y una base de datos PostgreSQL**, enfocándose en la manipulación, cruce y generación de reportes de información comercial.  
Se construye un pipeline de extracción, transformación y carga (ETL) a partir del esquema `classicmodels`, realizando cálculos de ventas, costos y ganancias, además de la creación de reportes analíticos en SQL y pandas.

---

## ⚙️ Tecnologías y librerías utilizadas
- **Python 3.10+**
- **PostgreSQL**
- **SQLAlchemy** (conexión a base de datos)
- **pandas / numpy**
- **psycopg2**
- **Google Colab**

---

## 🧠 Objetivos principales
1. **Conexión y lectura de tablas SQL:**  
   Se desarrolla una función `leer_tabla(tabla, engine)` para importar datos desde PostgreSQL a DataFrames.
   
2. **Cruce de tablas relacionales:**  
   Se integran las tablas `orders`, `orderdetails`, `customers`, `products` y `employees` con validación de integridad referencial.

3. **Cálculos financieros:**  
   - `venta = quantityOrdered * priceEach`  
   - `costo = quantityOrdered * buyPrice`  
   - `ganancia = venta - costo`

4. **Reportes de gestión:**  
   - Ventas totales por línea de producto.  
   - Identificación de clientes con y sin compras.  
   - Generación de reportes anuales y top 10 clientes y productos del año 2005.

5. **Persistencia de resultados:**  
   Reportes finales almacenados en PostgreSQL mediante la función `guardar_en_postgre()`.

---

## 📊 Resultados destacados
- **Ventas totales**: USD 9.6 millones.  
- **Clientes activos**: 98.  
- **Clientes sin compras**: 24.  
- **Líneas más rentables**: *Classic Cars* y *Vintage Cars*.  
- **Top 10 clientes 2005**: *Euro+ Shopping Channel*, *Mini Gifts Distributors*, *La Rochelle Gifts*, entre otros.  
- **Top 10 productos 2005**: *Ferrari 360 Spider (1992)*, *Dodge Charger (1969)*, *BMW R 1100 S (1997)*, entre otros.

---



